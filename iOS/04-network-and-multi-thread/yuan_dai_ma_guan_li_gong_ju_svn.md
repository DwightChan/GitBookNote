# 源代码管理工具-SVN

---
## 一. 了解源代码管理工具概述

### 1. 源代码管理工具的作用?
- 能追踪一个项目从诞生一直到定案的过程  
- 记录一个项目的所有内容变化,无限制返回  
- 查看特定版本的修订情况  


### 2. 常见的源代码管理工具有哪些?
	
- CVS
    - 开启版本控制之门
    - 1990年诞生，“远古时代”的主流源代码管理工具
- SVN
    - 全称是Subversion，集中式版本控制之王者
    - 是CVS的接班人，速度比CVS快，功能比CVS多且强大
    - 在国内软件企业中使用最为普遍（70%-90%）
- GIT
    - 一款伟大的分布式源代码管理工具
    - 目前被越来越多的开源项目使用
    - 不过在国内企业尚未大范围普及

### 3. 集中式和分布式的区别
	
1. [集中式和分布式资料链接](http://baike.baidu.com/link?url=amd48_OZDAdH7XQWaBsnxTmCfrkLLM8pizR3gtPETXF7cc1yk3nv_CpBVjxxoDl8YXP--Uh2tIVjiRYVvkwWSq)

2. [集中式和分布式资料链接](http://wenku.baidu.com/link?url=SnoaUsca-yywky7AcvZWvQpYxHP1UhPtggw3cJggUZHyDscSCZyJtp2a7XT5I8hgYW6tM09fvZjTTq5DrGIf6I6X9ubHTBahZkjaxgcoVGi)

3. [集中式和分布式资料链接](http://zhidao.baidu.com/question/32338956.html?qbl=relate_question_4&word=%BC%AF%D6%D0%CA%BD%20%B7%D6%B2%BC%CA%BD)


---

## 二. 掌握-SVN的基本介绍
### 1. 工作场景
1. 进入公司需要做的关于开发的第一件事, 就是向项目经理索要SVN服务器地址+用户名+密码

### 2. 角色解释
- 服务器: 用于存放所有版本的代码,供客户端上传下载更新
- 客户端: 通过客户端下载上传本地代码
- 用户名/密码: 验证人员身份,判断是否有操作权限;

### 3. 项目开发中的基本操作
- 项目经理初始化项目结构并上传到服务器
- 苦逼程序猿根据地址+用户名+密码下载一份完整代码到本地
- 开始开发,任务完成后,提交任务代码到服务器
- 从服务器上更新其他同事的代码到本地

### 4. 以上操作对应到SVN操作体现
- svn import (项目经理做的)
- svn checkout : 将服务器所有代码下载到本地
- svn commit : 提交本地最新代码到服务器
- svn update : 从服务器更新最新被修改的代码


### 5. 版本控制策略(补充)
- svn : 更新-修改-合并
    * 弊端:合并时容易产生冲突
- 其他版本控制策略: 锁定-修改-解锁
    * 弊端:不能并行开发

## 三. 了解-SVN服务器配置
1. 服务器作用
    - 用于存储/备份各个版本的代码
    - 供客户端下载/上传/删除代码
2. 服务器环境搭建
    - Mac 下直接配置([Mac 下安装SVN](http://tycomputer.iteye.com/blog/1963764)), ([Mac下配置SVN 服务器](http://blog.csdn.net/q199109106q/article/details/8655204))
    - Windows下安装Visual SVN Server([Visual SVN Server下载地址](http://www.visualsvn.com/server/download/))
    - *因为作为新人进到公司无法接触服务器,而且大部分公司都是使用windows 作为服务器,所以此处只讲第二种,作学习测试使用!*
3. 安装步骤
    - 全程”下一步”,傻瓜式安装.
4. 控制区几个选项的作用
    - Repository
        - 代码仓库:存放不同版本的代码
    - Users
        - 用户列表:创建或者删除用户,代码仓库设置访问权限时使用
    - Groups
        - 分组列表:将用户分组,可以针对每组进行代码仓库访问授权操作
5. 访问测试
    - 可以通过浏览器,输入代码仓库地址进行访问
    - 注意:在客户端浏览器访问时,注意地址需要使用对应的IP地址,不能使用计算机名称.
6. 操作补充
    - 在windows下面查看ip 地址
    - 开始 —- 运行   cmd 
    - 在命令行里面  运行 ipconfig

## 四. 掌握-UNIX基本命令
### 1. 必学命令
- help [子命令] : 查看某一个具体的子命令的使用方法

### 2. 常用命令
- cd path : 将当前路径切换到path路径
- pwd ：查看当前所在路径
- ls (-a / -l / -G) :  查看当前文件夹下所有文件及文件夹
- touch filename1 filename2 ： 创建一个或者多个文件 
- rm filename : 删除文件
- open filename ：打开文件
- cat filename ：查看文件内容
- more filename ：分页查看文件内容
- mkdir 文件夹名称 ：创建一个文件夹
- mv oldFilePath newFilePath ：移动文件(可借助此命令给文件重命名)
	
### 3. 补充
- `.`  代表当前文件路径
- `..` 代表上级目录
- 以`.`开头的文件,代表隐藏文件
    * 显示隐藏文件
         - defaults write com.apple.finder AppleShowAllFiles Yes && killall Finder
    * 不显示隐藏文件
        - defaults write com.apple.finder AppleShowAllFiles No && killall Finder


### 4. 使用注意
-  命令和参数之间需要添加空格
-  如果要使用当前目录中的文件名，输入到一半时，按TAB键能够补全

---

## 五. 掌握-SVN终端演练(个人开发)
### 1. 命令格式

	命令行格式：
		svn <subcommand> [options] [args]
		svn 子命令 [选项] [参数]

	其中中括号里面的内容可以省略
	
### 2. 必学命令
	svn [子命令] --help
	svn help [子命令]
	
### 3. 实战演练
1. 项目经理初始化项目,并上传到SVN服务器
		
		方案1: 
			(1) 创建临时项目
			(2) svn import [path] URL --username=用户名 --password=密码 -m "注释"
			
		方案2:
			(1) svn checkout URL [path] --username=用户名 --password=密码 : 初始化本地仓库
			(2) 创建项目
			(3) 使用 svn add 命令将项目所有文件添加到本地版本控制
			(4) 使用 svn commit 提交本地项目到远程服务器		

2. 程序猿从服务器下载一份完整代码到本地开始开发	

		svn checkout URL [path] --username=用户名 --password=密码
		
3. 修改文件提交

		(1) 修改文件
		(2) 使用svn commit -m "注释" : 提交本地文件到服务器
		
4. 新建文件提交

		(1) 新建文件
		(2) 使用 svn add 命令将项目所有文件添加到本地版本控制
		(3) 使用 svn commit -m "注释" : 提交本地项目到远程服务器

5. 删除文件提交

	*一定不要手动删除文件*
		
		(1) svn remove filename 或者 svn delete filename 从本地版本控制以及对应文件删除
		(2) svn commit -m "注释"  : 提交本地操作到服务器, 使服务器也删除对应的文件
		
6. 常用命令补充

		1. svn status 
			查看当前工作空间内, 所有 有变化的文件 的状态
			如果执行此命令什么都没输出, 代表本地没有东西要提交
		2. svn log 
			查看当前版本的操作日志(什么人, 什么时间, 做了什么操作)
			
7. 版本控制中,各个文件状态参考

		' ' 没有修改
		'A' 被添加到本地版本控制
		'C' 冲突
		'D' 被删除(通过svn命令删除的文件）
		'I' 被忽略
		'M' 被修改
		'R' 被替换
		‘G’ 被合并
		‘U’ 已经更新
		‘E’ 已经存在
		'X' 外部定义创建的版本目录
		'?' 文件没有被添加到本地版本控制
		'!' 文件丢失或者不完整（不是通过svn命令删除的文件）
			注意: 不要直接手动将文件删除到废纸篓, 
		'' 受控文件被其他文件阻隔

8. 注意事项

		* 任何本地的操作, 如果想让服务器也做同样的操作, 就直接通过 commit操作 提交到服务器
		* 任何向服务器提交的操作,都要加注释 添加 -m参数 


----

## 六. 掌握-SVN终端演练(多人开发)
0. 准备工作

		熊大和熊二,分别通过
			svn checkout URL [path] --username=用户名 --password=密码 
		命令初始化本地版本控制库

1. 添加文件同步

		1. 熊大创建文件并提交到服务器
			svn add fileName
			svn commit -m "新增文件"
		2. 熊二从服务器更新文件
			svn update 

2. 修改文件同步

		1. 熊大修改文件并提交到服务器
			svn commit -m "修改文件"
		2. 熊二从服务器更新文件
			svn update 
			
3. 删除文件同步

		1. 熊大删除文件并提交到服务器
			svn delete fileName
			svn commit -m "删除文件"
		2. 熊二从服务器更新文件
			svn update
			
4. 多人合作开发中的常见问题
		
		* 问题一 : 超时
			问题描述:
				当本地文件版本小于服务器文件版本时, 如果要提交本地文件,就会报 out of date 超时错误
			产生原因:
				SVN通过版本号管理每一个文件,如果一个文件被修改并提交到服务器,那么服务器上的对应文件版本号就会加1, 如果你的版本号小于服务器版本号,就说明,肯定有别人在后来又修改了那个文件
			解决方案:
				针对于超时问题,对应的解决方案,就是先从服务器更新下最新版本, 保证本地版本号与服务器版本号一致,这是文件可以提交的前提
			
		* 问题二 : 冲突
			问题描述:
				为了解决超时问题,只能更新.而在更新过程中,如果几个人修改了同一文件的同一行代码,此时就会产生冲突
			产生原因:
				版本控制器不会那么智能, 去决定应该使用谁的代码作为最终代码,只能将选择权抛给用户,让用户解决
			解决方案:
				系统提供三种解决方案:
				 (p) postpone,  
				 	延迟处理(待会我自己处理), 如果选择这一种, 会自动生成三个文件供用户参考决策. 并将冲突部分代码块合并到一起. 而一旦解决完毕, 需要执行 svn resolved fileName 来告诉版本控制器已经解决, 然后版本控制器就会自动删除三个参考文件
				 (mc) mine-conflict
				 	使用我的(本地的), 如果代码产生冲突, 则以本地代码为准
				 (tc) theirs-conflict
				 	使用他人的(服务器), 如果代码产生冲突, 则以服务器代码为准
				 					 	
        <<<<<<< .mine
            此处代表是我的代码
        =======
            此处代表服务器代码
        >>>>>>> .r7
				 	
				 	
----

## 七. 了解-SVN终端演练-版本回退
1. 版本回退概念以及原因?
	
		概念: 是指将代码(本地代码或者服务器代码), 回退到之前记录的某一特定版本
		原因: 如果代码做错了, 想返回之前某个状态重做;
		
2. 修改了,但未提交的情况下, 回退代码

		方案1: (大力推荐)
			svn revert (作用:返回到上次提交后版本对应的最原始的状态)
			
		方案2: (不推荐)
		   删除整个项目,重新checkout

3. 修改了,并且提交了的情况反悔

		方案1: 大力推荐
		 	- svn update 
		 		(作用: 将本地代码更新到与服务器相同的版本)
		 	- svn merge 文件名 -r 版本1:版本2
				(作用: 把版本1 -> 版本2 的 diff 作用在当前版本)
		  	- svn commit -m “本地和服务器都回退到某一指定版本”
		  		(作用: 让服务器代码也退回到之前某个版本状态)

		方案2: 
		  - svn update -r 指定版本号(此时本地代码已经变化,但是服务器没有改变)
			*--------以下步骤是为了让服务器代码也回滚到以前的版本----------*
		  - 修改部分文件
		  - svn update (此时会产生冲突, 选择使用自己的代码即可)
		  - 再次提交代码

		方案3:
		   - 手动保存需要回退的文件内容
		   - 删除文件,提交到服务器
		   - 重新添加文件,上传到服务器

----

## 八. 掌握-Cornerstone基本使用
1. 掌握如何添加远程代码仓库的关联
2. 掌握如何checkout, 下载服务器代码, 以及初始化本地版本控制库
3. 掌握如何新建文件提交, 修改文件提交, 删除文件提交
4. 掌握版本日志查看, 以及了解版本回退
5. 掌握多人开发中的超时问题和冲突问题的解决

----

## 九. 掌握-Xcode管理SVN
1. 掌握怎样添加远程代码仓库的关联
2. 掌握怎样checkout, 下载服务器代码, 以及初始化本地版本控制库
3. 掌握怎样新建文件提交, 修改文件提交, 删除文件提交
4. 掌握版本日志查看, 以及了解版本回退
5. 掌握多人开发中的超时问题和冲突问题的解决

*开发经验: 最好忽略没必要提交的文件*

	** 过滤不需要上传的文件, 忽略文件(xcuserdata文件夹)**
		> 文件打开状态
		> 断点信息
		> 文件夹关闭打开状态
	** 注意:projct setting文件不要忽略 **
		> 存放一些文件顺序和文件夹结构,文件引用等信息

----

## 十. 了解-SVN目录规范
1. 文件目录作用?

		trunk : 主干，当前开发项目的主目录;
		 	我们之前更新代码，提交代码都是在这个文件夹进行操作
		
		brannches:分支目录
			添加非主线功能时使用，开发测试之后，可以合并到主干项目中。修复Bug，研发不确定的新功能都在这里做
		
		tags:标记目录，通常作为重大版本的备份；
			如果有发布版本出现Bug，可以快速的找到对应版本的项目备份，然后开一个分支，进行Bug修复，用于与主干区分

2. 掌握利用图形客户端版本备份流程
3. 了解已发布版本bug解决流程

---

## 十一. 了解-SVN 托管平台

### 1. svnspot

    http://code.svnspot.com
 		
### 2. svnchina

    http://www.svnchina.com

